# PG-Dev AI设计助理项目架构设计

## 项目概述

PG-Dev项目是一个基于Creo的对话式AI设计助理系统，通过自然语言交互实现小家电产品的智能化设计。项目采用分层架构设计，通过标准化的目录结构、规范化的开发流程、自动化的工具支持，为AI设计助理的开发和生产应用提供稳定、高效的基础设施。

## 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                    用户交互层                              │
├─────────────────────────────────────────────────────────────┤
│  对话界面  │  自然语言处理  │  设计意图理解  │  结果展示    │
├─────────────────────────────────────────────────────────────┤
│                    AI智能层                               │
├─────────────────────────────────────────────────────────────┤
│  GPT-4/Claude  │  意图识别  │  参数提取  │  脚本生成      │
├─────────────────────────────────────────────────────────────┤
│                    脚本执行层                              │
├─────────────────────────────────────────────────────────────┤
│  Python脚本  │  参数验证  │  Creo API调用  │  错误处理     │
├─────────────────────────────────────────────────────────────┤
│                    CAD软件层                               │
├─────────────────────────────────────────────────────────────┤
│  Creo软件  │  3D建模  │  装配设计  │  工程图生成  │  导出    │
└─────────────────────────────────────────────────────────────┘
```

## 项目目录结构与功能定位

### 核心目录架构

根据项目实际需求，PinGao项目采用以下标准目录结构：

```
PinGao/
├── docs/                      # 项目开发依据的重要文档
├── project/                   # 项目开发成果
├── tools/                     # 项目开发过程中使用到的工具与资源
├── AI助理生产成果/             # 利用项目开发成果进行现实生产的产出
├── bak/                       # 项目备份目录
└── logs/                      # 开发及调试使用过程各种记录
```

### 1. docs/ - 项目开发依据的重要文档

**功能定位**: 存储项目开发过程中的核心文档，为项目开发提供理论依据和技术指导。

**目录结构**:
```
docs/
├── 01-设计/                   # 设计阶段文档
│   ├── 开发任务书.md           # 项目开发任务书
│   ├── 技术方案.md             # 对话式AI设计助理技术方案
│   ├── 目录结构标准清单.md     # 项目目录结构规范
│   └── 项目架构设计.md         # 项目架构设计文档
├── 02-开发/                   # 开发阶段文档
│   ├── MCP项目隔离实现说明.md  # MCP项目隔离技术说明
│   ├── memory.json            # AI助理记忆存储
│   ├── 开发日志.md             # 开发过程记录
│   └── 故障排除指南.md         # 问题解决指南
├── 03-管理/                   # 项目管理文档
│   ├── project_config.yaml    # 项目配置文件
│   ├── 工具资产清单.md         # 工具和资源清单
│   ├── 看板.md                 # 项目进度看板
│   └── 规范与流程.md           # 开发规范和流程
├── 04-模板/                   # 模板和示例
│   ├── project_init_script.py # 项目初始化脚本
│   ├── 代码示例库/             # 代码示例集合
│   ├── 技术选型指南.md         # 技术选型参考
│   └── 项目结构模板.md         # 项目结构模板
└── 05-生产成果/               # 生产相关文档
```

**核心价值**:
- 提供项目开发的理论基础和技术指导
- 确保开发过程的规范性和一致性
- 为团队协作提供统一的文档标准

### 2. project/ - 项目开发成果

**功能定位**: 存储项目的核心代码、配置文件和开发成果，是项目的主要交付物。

**目录结构**:
```
project/
├── .devcontainer/             # 开发容器配置
├── .eslintrc.js              # ESLint配置
├── .pre-commit-config.yaml   # 预提交钩子配置
├── .prettierrc               # Prettier配置
├── package.json              # Node.js依赖配置
├── requirements.txt          # Python依赖配置
├── public/                   # 静态资源
├── src/                      # 源代码目录
│   ├── __tests__/            # 测试文件
│   ├── config/               # 配置文件
│   ├── client.ts             # 客户端代码
│   ├── index.js              # 主入口文件
│   └── styles/               # 样式文件
├── scripts/                  # 脚本文件
│   ├── health_check.sh       # 健康检查脚本
│   ├── init_project.sh       # 项目初始化脚本
│   └── quality-check.sh      # 代码质量检查脚本
├── tests/                    # 测试目录
├── htmlcov/                  # 测试覆盖率报告目录（自动生成）
├── .coverage                 # 测试覆盖率数据文件（自动生成）
└── [配置文件]                # 各种配置文件
```

**核心价值**:
- 包含AI设计助理的核心功能代码
- 提供完整的开发环境配置
- 确保代码质量和项目可维护性

### 3. tools/ - 项目开发过程中使用到的工具与资源

**功能定位**: 存储项目开发过程中使用的各种工具、脚本和资源文件。

**主要内容**:
- 自动化脚本和工具
- 开发辅助工具
- 项目管理工具
- 第三方工具集成

**核心价值**:
- 提高开发效率
- 自动化重复性工作
- 标准化开发流程

### 4. AI助理生产成果/ - 利用项目开发成果进行现实生产的产出

**功能定位**: 存储使用AI设计助理系统实际生产的设计成果和产品文件。

**主要内容**:
- 通过AI助理生成的3D模型文件
- 设计方案和技术文档
- 生产制造相关文件
- 客户交付成果

**核心价值**:
- 展示AI设计助理的实际应用效果
- 积累设计案例和经验
- 为产品改进提供反馈数据

### 5. bak/ - 项目备份目录

**功能定位**: 用于备份项目开发过程及开发成果，包括docs、project、tools等核心目录的备份。其中，项目git、github备份仓库建立在此文件夹下。

**目录结构**:
```
bak/
├── github_repo/               # GitHub仓库备份
├── test_project/              # 测试项目备份
├── 专项备份/                  # 专项功能备份
├── 迁移备份/                  # 项目迁移备份
├── 待清理资料/                # 待清理资料
├── 常规备份/                  # 常规备份
└── [时间戳备份文件]           # 按时间戳命名的备份文件
```

**核心价值**:
- 确保项目数据安全
- 支持版本回滚和恢复
- 提供项目历史追溯能力
- 集中管理Git和GitHub备份仓库

### 6. logs/ - 开发及调试使用过程各种记录

**功能定位**: 记录项目开发、调试、运行过程中的各种日志信息。

**目录结构**:
```
logs/
├── archive/                   # 归档日志
├── error_detection/           # 错误检测日志
├── 其他日志/                  # 系统其他日志
├── 工作记录/                  # 工作记录日志
└── 检查报告/                  # 各类检查报告
```

**核心价值**:
- 提供问题诊断和调试信息
- 记录项目开发历程
- 支持性能分析和优化

## 技术架构设计

### 1. 对话式AI设计助理核心架构

#### 1.1 系统组件

```
用户输入 → 自然语言理解 → 意图识别 → 参数提取 → 脚本生成 → Creo API调用 → 3D模型生成
    ↓           ↓           ↓         ↓         ↓           ↓            ↓
  语音/文字   GPT-4/Claude   AI分析   参数验证   Python脚本   Creo软件    设计成果
```

#### 1.2 技术栈选择

**AI接口层**:
- 自然语言处理: GPT-4 或 Claude API
- 对话界面: 现有对话系统（无需额外开发）

**脚本执行层**:
- 编程语言: Python 3.9+
- Windows API: pywin32
- 错误处理: 自定义异常处理机制

**CAD集成层**:
- CAD软件: Creo (本地安装)
- API接口: Creo COM接口 或 Pro/TOOLKIT API
- 数据格式: .prt, .asm, .drw

### 2. 开发环境架构

#### 2.1 本地开发环境

```
┌─────────────────────────────────────────┐
│            开发环境                      │
├─────────────────────────────────────────┤
│  IDE层                                 │
│  ├── VS Code / PyCharm                │
│  ├── Trae AI IDE                      │
│  └── 调试工具                          │
├─────────────────────────────────────────┤
│  运行时层                               │
│  ├── Python 3.9+                     │
│  ├── Node.js 18+ (可选)              │
│  └── Creo软件                          │
├─────────────────────────────────────────┤
│  系统层                                 │
│  ├── Windows 10/11                   │
│  ├── Git版本控制                       │
│  └── 虚拟环境管理                      │
└─────────────────────────────────────────┘
```

#### 2.2 代码质量保证

**Python代码质量**:
- 代码检查: Flake8, Pylint
- 代码格式化: Black, autopep8
- 类型检查: mypy
- 测试框架: pytest

**JavaScript/TypeScript代码质量** (如需要):
- 代码检查: ESLint
- 代码格式化: Prettier
- 测试框架: Jest

### 3. 部署架构

#### 3.1 本地部署模式

```
用户工作站
├── AI设计助理系统
│   ├── 对话界面
│   ├── Python脚本引擎
│   └── 配置管理
├── Creo软件
│   ├── 3D建模模块
│   ├── 装配设计模块
│   └── 工程图模块
└── 数据存储
    ├── 设计模板库
    ├── 历史记录
    └── 用户配置
```

**部署优势**:
- 零服务器成本
- 数据安全性高
- 响应速度快
- 离线工作能力

## 开发流程设计

### 1. 三阶段开发计划

#### 阶段一: 基础功能开发 (2-3周)
**目标**: 实现基础几何体创建和操作

**交付物**:
- Creo连接脚本
- 基础几何体生成（圆柱、长方体、球体、圆锥）
- 参数解析模块
- 基本操作（拉伸、旋转、切除）

#### 阶段二: 智能化提升 (3-4周)
**目标**: 实现复杂操作和智能化功能

**交付物**:
- 复杂操作脚本（倒角、圆角、阵列）
- 装配体操作
- 设计模板库
- 智能参数识别

#### 阶段三: 完整产品设计 (4-5周)
**目标**: 实现完整的产品设计自动化

**交付物**:
- 工程图自动生成
- 材料工艺建议
- 设计规则检查
- 成本估算功能

### 2. 质量保证流程

```
代码开发 → 单元测试 → 集成测试 → Creo测试 → 用户验收测试
    ↓         ↓         ↓         ↓         ↓
  功能实现   模块验证   系统验证   CAD验证   实际应用
```

## 安全设计

### 1. 数据安全
- **本地存储**: 所有设计数据存储在本地，避免云端泄露风险
- **访问控制**: 文件权限管理，防止未授权访问
- **备份策略**: 定期自动备份重要设计文件

### 2. 系统安全
- **API安全**: Creo API调用权限控制
- **脚本安全**: Python脚本执行环境隔离
- **错误处理**: 完善的异常处理机制

### 3. 知识产权保护
- **设计文件加密**: 重要设计文件加密存储
- **访问日志**: 记录所有设计文件访问日志
- **版本控制**: Git版本控制，追踪设计变更历史

## 性能优化

### 1. 响应速度优化
- **脚本缓存**: 常用脚本预加载和缓存
- **参数验证**: 前置参数验证，减少无效API调用
- **批量操作**: 支持批量几何操作，提高效率

### 2. 资源使用优化
- **内存管理**: 及时释放Creo对象，避免内存泄露
- **CPU优化**: 异步处理非关键操作
- **存储优化**: 压缩存储设计历史和模板

### 3. 用户体验优化
- **进度反馈**: 实时显示操作进度
- **错误提示**: 友好的错误信息和解决建议
- **操作撤销**: 支持操作撤销和重做

## 扩展性设计

### 1. 功能扩展
- **插件机制**: 支持自定义功能插件
- **模板扩展**: 可扩展的设计模板库
- **API扩展**: 预留API接口，支持第三方集成

### 2. 技术扩展
- **多CAD支持**: 预留接口支持其他CAD软件
- **云端集成**: 可选的云端功能集成
- **移动端支持**: 预留移动端接口

### 3. 业务扩展
- **行业模板**: 支持不同行业的设计模板
- **协作功能**: 团队协作和设计分享
- **数据分析**: 设计数据分析和优化建议

## 维护和升级

### 1. 版本管理
- **语义化版本**: 遵循SemVer版本规范
- **变更日志**: 详细记录每个版本的变更
- **兼容性**: 保持向后兼容性

### 2. 文档维护
- **自动更新**: 代码变更自动更新相关文档
- **版本同步**: 文档版本与代码版本同步
- **示例更新**: 保持示例代码的时效性

### 3. 技术支持
- **问题跟踪**: 完善的问题跟踪和解决机制
- **用户反馈**: 收集和处理用户反馈
- **定期更新**: 定期更新依赖和工具版本

## 总结

PinGao AI设计助理项目通过清晰的目录结构、分层架构设计、规范化开发流程，为基于Creo的对话式AI设计助理提供了完整的技术解决方案。项目架构的核心价值在于：

1. **目录结构清晰**: 每个目录都有明确的功能定位和价值
   - **docs/**: 项目开发依据的重要文档
   - **project/**: 项目开发成果
   - **tools/**: 项目开发过程中使用到的工具与资源
   - **AI助理生产成果/**: 利用项目开发成果进行现实生产的产出
   - **bak/**: 项目备份，包括git、github备份仓库
   - **logs/**: 开发及调试使用过程各种记录

2. **技术方案务实**: 基于本地Creo软件，避免复杂的Web开发
3. **开发效率高**: 总开发周期仅需2-3个月
4. **部署成本低**: 本地部署，零服务器成本
5. **扩展性强**: 预留多种扩展接口和升级路径

S:\PG-Dev\docs\01-设计\目录结构标准清单.md## 缓存系统设计

### .cache/ 目录架构

**功能定位**: 项目性能优化的核心组件，通过智能缓存机制大幅提升开发工具的执行效率。

**目录结构**:
```
.cache/
└── structure/                 # 目录结构缓存
    └── structure_cache.json   # 目录结构扫描缓存文件
```

### 缓存机制设计

#### 1. 智能缓存策略
- **TTL机制**: 24小时缓存有效期，平衡性能与数据新鲜度
- **增量更新**: 通过文件修改时间检测，只重新扫描变化的目录
- **哈希验证**: 使用目录哈希值快速判断内容是否发生变化
- **自动清理**: 过期缓存自动清理，避免磁盘空间浪费

#### 2. 性能优化效果
- **扫描加速**: 将目录结构扫描时间从0.04秒降至几乎0秒
- **资源节约**: 减少磁盘I/O操作，降低系统资源消耗
- **响应提升**: 频繁运行的结构检查工具响应速度显著提升

#### 3. 配置管理
根据`project_config.yaml`中的缓存配置：
```yaml
cache:
  enabled: true                    # 缓存启用状态
  cache_file: structure_cache.json # 缓存文件名
  ttl_hours: 24                    # 缓存有效期（小时）
  cache_dir: .cache/structure      # 缓存目录路径
  check_mtime: true                # 启用文件修改时间检查
```

#### 4. 技术实现
- **缓存数据结构**: JSON格式存储，包含时间戳、目录结构、哈希值和统计信息
- **并发安全**: 支持多进程安全访问，避免缓存冲突
- **错误恢复**: 缓存损坏时自动重建，确保系统稳定性

### 缓存系统价值

1. **开发效率提升**: 工具脚本执行速度显著提升，改善开发体验
2. **系统资源优化**: 减少重复计算和磁盘访问，提高系统整体性能
3. **扩展性支持**: 为未来更多缓存需求提供基础架构
4. **维护成本降低**: 自动化缓存管理，减少人工维护工作

**重要提醒**: 
- **docs/** 目录是项目的理论基础，需要持续维护和更新
- **project/** 目录是项目的核心交付物，需要严格的质量控制
- **tools/** 目录提供开发效率支持，需要不断优化和完善
- **AI助理生产成果/** 目录展示项目价值，需要积累优秀案例
- **bak/** 和 **logs/** 目录确保项目安全，需要定期清理和归档
- **.cache/** 目录是性能优化的关键组件，确保开发工具高效运行

通过这种架构设计，PinGao项目将为小家电设计行业提供一个高效、智能、易用的AI设计助理解决方案。