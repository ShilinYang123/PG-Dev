# PMC全流程图表界面应用软件产品功能需求规格书

## 产品概述

### 产品定位
PMC全流程图表界面应用软件是一套专为小家电生产企业设计的现代化PMC（生产计划与物料控制）管理系统。基于BD400原始订单表和现有PMC工作流程，实现从订单接收到产品交付的全流程可视化管理，集成微信、手机、邮件的自动跟进与催办功能，为企业提供完整的PMC控制解决方案。

### 核心价值主张
- **全流程可视化**：图表界面展示从订单到交付的完整流程
- **智能项目管理**：AI驱动的项目创建和任务分配
- **实时监控预警**：24小时不间断的生产进度监控和异常预警
- **多渠道智能催办**：微信、邮件、语音等多种自动催办方式
- **数据驱动决策**：基于实时数据的绩效分析和优化建议

### 应用场景
- **订单管理**：从BD400订单表导入到订单交付的全流程管理
- **生产计划**：基于订单需求的智能排程和产能分析
- **物料控制**：BOM管理、库存监控、采购计划和供应商管理
- **进度跟踪**：实时生产进度监控和质量跟踪
- **协同工作**：多部门协作的统一工作平台

## 功能需求详述

### 1. 订单管理模块

#### 1.1 订单导入与处理
**功能描述**：基于BD400原始订单表的订单数据导入和处理

**具体需求**：
- 支持Excel文件批量导入订单数据
- 自动解析订单信息（订单号、客户、产品、数量、交期等）
- 订单数据验证和异常提示
- 支持手动录入和修改订单信息
- 订单状态跟踪（待评审、已确认、生产中、已完成等）

**数据字段要求**：
- 订单编号、客户名称、产品型号、订单数量
- 单价、总金额、下单日期、要求交期
- 客户联系人、联系方式、特殊要求
- 订单优先级、订单状态、备注信息

#### 1.2 订单评审工作流
**功能描述**：可配置的订单评审流程管理

**评审流程**：
- **技术评审**：产品规格确认、工艺可行性评估
- **商务评审**：价格确认、交期评估、合同条款
- **生产评审**：产能评估、物料可用性检查
- **最终确认**：订单正式确认和生产计划启动

**评审功能**：
- 评审任务自动分配给相关部门
- 评审意见记录和汇总
- 评审结果通知和流程推进
- 评审历史记录和追溯

#### 1.3 客户管理
**功能描述**：客户信息维护和关系管理

**客户信息**：
- 客户基本信息（名称、地址、联系方式）
- 客户分类和等级管理
- 客户联系人和部门信息
- 客户历史订单记录
- 客户信用和付款记录

### 2. 生产计划模块

#### 2.1 智能排程管理
**功能描述**：基于约束条件的智能生产排程

**排程功能**：
- 基于订单交期的自动排程
- 产能约束和设备能力考虑
- 物料可用性检查和排程优化
- 工艺路线和加工时间计算
- 排程冲突检测和解决方案

**排程算法**：
- 关键路径法（CPM）
- 有限产能排程（FCS）
- 瓶颈资源优化
- 多目标优化（交期、成本、效率）

#### 2.2 产能分析
**功能描述**：实时产能评估和瓶颈识别

**分析内容**：
- 设备产能利用率分析
- 人员工作负荷分析
- 瓶颈工序识别和优化建议
- 产能缺口预警和解决方案
- 产能规划和扩展建议

#### 2.3 甘特图可视化
**功能描述**：可交互的生产计划甘特图展示

**甘特图功能**：
- 时间轴可缩放（日、周、月视图）
- 任务依赖关系显示
- 拖拽调整任务时间
- 关键路径高亮显示
- 进度实时更新和颜色标识
- 资源分配和冲突提示

### 3. 物料管理模块

#### 3.1 BOM管理
**功能描述**：产品BOM结构维护和版本控制

**BOM功能**：
- 多层级BOM结构展示
- BOM版本管理和变更控制
- 物料替代关系管理
- BOM成本计算和分析
- BOM导入导出功能

#### 3.2 库存管理
**功能描述**：实时库存监控和预警管理

**库存功能**：
- 实时库存数量和状态监控
- 安全库存和最低库存预警
- 呆滞料识别和处理建议
- 库存周转率分析
- 库存盘点和调整

#### 3.3 采购管理
**功能描述**：采购计划生成和执行跟踪

**采购功能**：
- MRP计算和采购需求生成
- 供应商选择和询价比价
- 采购订单生成和跟踪
- 到货检验和入库管理
- 采购绩效分析

#### 3.4 供应商管理
**功能描述**：供应商信息和绩效管理

**供应商功能**：
- 供应商基本信息维护
- 供应商分类和等级管理
- 供应商绩效评估
- 供应商准入和退出管理
- 供应商协同平台

### 4. 进度跟踪模块

#### 4.1 实时监控看板
**功能描述**：生产进度实时监控和可视化展示

**监控内容**：
- 订单完成进度和状态
- 生产任务执行情况
- 设备运行状态和效率
- 质量检验结果
- 异常事件和处理状态

**看板功能**：
- 多维度数据展示（图表、表格、仪表盘）
- 实时数据刷新和预警提示
- 钻取查询和详细分析
- 自定义看板配置

#### 4.2 异常预警系统
**功能描述**：生产异常自动识别和预警通知

**预警类型**：
- 交期延迟预警
- 质量异常预警
- 设备故障预警
- 物料短缺预警
- 产能瓶颈预警

**预警机制**：
- 多级预警阈值设置
- 自动预警通知发送
- 预警升级和处理跟踪
- 预警历史记录和分析

#### 4.3 质量跟踪
**功能描述**：质量检验结果跟踪和分析

**质量功能**：
- 检验计划和标准管理
- 检验结果录入和统计
- 不良品处理和追溯
- 质量趋势分析
- 质量改进建议

### 5. 智能项目创建模块

#### 5.1 自然语言输入处理
**功能描述**：用户通过对话窗口输入新项目需求或会议纪要

**具体需求**：
- 支持中文自然语言输入
- 支持文本粘贴和文件上传
- 支持语音转文字输入
- 输入内容长度支持1000-10000字符

#### 5.2 智能信息提取
**功能描述**：AI自动识别和提取项目关键信息

**提取内容**：
- **人员信息**：姓名、部门、职务、联系方式
- **任务信息**：任务名称、负责人、截止时间、优先级
- **项目信息**：项目名称、项目类型、预计周期
- **时间节点**：关键里程碑、交付时间

#### 5.3 自动项目建立
**功能描述**：在`S:\PG-PMC\AI调度表`下自动创建项目管理结构

**创建内容**：
- 项目文件夹（以项目ID命名）
- 项目基本信息表（Excel格式）
- 任务跟踪表（包含任务、负责人、时间、状态等字段）
- 联系人清单（包含所有参与人员的联系方式）
- 项目日志文件（记录所有操作历史）

### 6. 自动化跟单系统

#### 6.1 任务节点监控
**功能描述**：实时监控所有任务节点的完成状态

**监控内容**：
- 任务进度状态（未开始、进行中、已完成、延迟）
- 任务剩余时间计算
- 任务风险等级评估
- 依赖关系检查
- 资源分配和冲突检测

**监控频率**：
- 正常任务：每日检查一次
- 紧急任务：每4小时检查一次
- 临近截止任务：每小时检查一次
- 关键路径任务：实时监控

#### 6.2 智能催收提醒
**功能描述**：根据任务状态和紧急程度自动发送提醒

**提醒策略**：
- **绿色提醒**：任务开始前1天，微信提醒
- **黄色提醒**：任务截止前1天，微信+邮件提醒
- **橙色提醒**：任务截止前4小时，微信+邮件+电话提醒
- **红色警报**：任务延迟，立即多渠道提醒+升级

**智能催收功能**：
- 基于历史数据的个性化提醒策略
- 工作时间和休息时间的智能识别
- 提醒频率自适应调整
- 提醒效果跟踪和优化

#### 6.3 多级升级机制
**功能描述**：未响应时自动升级提醒级别

**升级流程**：
1. **第一级**：任务负责人（微信提醒）
2. **第二级**：直接主管（邮件+微信）
3. **第三级**：部门负责人（电话+邮件+微信）
4. **第四级**：项目经理/PMC负责人（紧急会议通知）

**升级时间间隔**：
- 正常任务：24小时无响应升级
- 紧急任务：4小时无响应升级
- 关键任务：1小时无响应升级

### 7. 多渠道通知系统（MCP工具集成）

#### 7.1 微信通知
**功能描述**：通过企业微信或微信小程序发送通知

**实现方式**：
- 集成企业微信API
- 微信小程序消息推送
- 支持群组通知和个人通知
- 消息模板管理

**通知内容**：
- 订单状态更新通知
- 生产进度提醒
- 异常预警消息
- 任务分配和完成通知
- 质量检验结果通知

#### 7.2 邮件系统
**功能描述**：发送正式的邮件通知和文档

**邮件类型**：
- 订单确认和变更通知
- 生产计划和排程邮件
- 采购需求和到货通知
- 质量报告和异常通知
- 绩效报告和分析邮件

**邮件功能**：
- 支持HTML格式和富文本
- 自动附加相关文档和报表
- 支持抄送、密送和群发
- 邮件模板管理
- 发送状态跟踪

#### 7.3 短信通知
**功能描述**：紧急情况下的短信提醒

**触发条件**：
- 生产异常和设备故障
- 交期延迟风险
- 质量问题和客户投诉
- 关键任务未响应

**短信功能**：
- 短信模板管理
- 批量短信发送
- 发送状态跟踪
- 回复消息处理

#### 7.4 其他通知渠道
**功能描述**：集成钉钉、Teams等企业通讯工具

**支持平台**：
- 钉钉机器人和应用通知
- Microsoft Teams集成
- 企业QQ和腾讯会议
- 飞书和字节跳动套件

### 8. 全程记录与追踪

#### 8.1 订单全生命周期记录
**功能描述**：记录订单从接收到交付的完整过程

**记录内容**：
- 订单接收和评审记录
- 生产计划和排程变更历史
- 物料采购和到货记录
- 生产执行和进度更新
- 质量检验和问题处理
- 包装发货和客户确认

#### 8.2 操作日志管理
**功能描述**：详细记录所有系统操作和业务活动

**日志类型**：
- 用户登录和操作日志
- 数据变更和审计日志
- 系统运行和性能日志
- 通知发送和响应日志
- 异常和错误处理日志

#### 8.3 数据可视化
**功能描述**：提供直观的业务数据和趋势展示

**可视化内容**：
- 订单完成率和交期达成率
- 生产效率和设备利用率
- 库存周转率和物料消耗
- 质量合格率和客户满意度
- 部门绩效和人员效率

**图表类型**：
- 甘特图、柱状图、折线图
- 饼图、散点图、热力图
- 仪表盘、KPI卡片
- 趋势分析和对比图表

### 9. 报表分析模块

#### 9.1 生产报表
**功能描述**：生产效率、质量、成本分析报表

**报表类型**：
- 生产计划执行报表
- 设备利用率分析报表
- 人员效率统计报表
- 生产成本分析报表
- 质量统计和趋势报表

#### 9.2 订单报表
**功能描述**：订单完成率、交期达成率统计

**报表内容**：
- 订单接收和确认统计
- 订单完成率分析
- 交期达成率统计
- 客户满意度调查
- 订单变更和取消分析

#### 9.3 库存报表
**功能描述**：库存周转率、呆滞料分析

**报表功能**：
- 库存周转率分析
- 呆滞料识别和处理
- 采购成本分析
- 供应商绩效评估
- 物料消耗趋势分析

#### 9.4 绩效报表
**功能描述**：部门和个人绩效评估

**绩效指标**：
- 部门任务完成率
- 个人工作效率
- 响应速度和质量
- 协作配合度评估
- 改进建议和行动计划

#### 9.5 自定义报表
**功能描述**：用户自定义报表配置

**自定义功能**：
- 报表字段和指标选择
- 筛选条件和时间范围
- 图表类型和样式设置
- 报表模板保存和共享
- 定时生成和自动发送

### 10. 绩效评定系统

#### 10.1 部门绩效评估
**功能描述**：基于多维度指标评估部门绩效

**评估指标**：
- 订单按时完成率
- 生产效率和质量指标
- 成本控制和资源利用
- 客户满意度和投诉处理
- 团队协作和沟通效果

#### 10.2 个人绩效跟踪
**功能描述**：跟踪和评估个人工作表现

**跟踪指标**：
- 个人任务完成率和质量
- 响应速度和及时性
- 主动性和创新能力
- 学习成长和技能提升
- 团队贡献和协作精神

#### 10.3 绩效分析和改进
**功能描述**：绩效数据分析和改进建议

**分析功能**：
- 绩效趋势分析和对比
- 影响因素识别和分析
- 最佳实践总结和推广
- 改进计划制定和跟踪
- 激励机制和奖惩措施

### 11. 系统管理模块

#### 11.1 用户管理
**功能描述**：用户账号、角色、权限管理

**用户功能**：
- 用户账号创建和维护
- 角色定义和权限分配
- 用户组织架构管理
- 登录认证和安全控制
- 用户行为审计

#### 11.2 系统配置
**功能描述**：系统参数配置和维护

**配置内容**：
- 业务参数和规则配置
- 通知模板和策略设置
- 报表格式和样式配置
- 集成接口和API配置
- 系统性能和安全设置

#### 11.3 数据管理
**功能描述**：基础数据维护和管理

**数据类型**：
- 产品信息和BOM数据
- 客户和供应商信息
- 工艺路线和标准工时
- 设备信息和产能数据
- 质量标准和检验规范

### 12. 应用程序调用

#### 12.1 集成现有工具
**功能描述**：调用`S:\PG-PMC\project`中的应用程序

**集成方式**：
- 通过API接口调用
- 命令行工具调用
- 文件交换接口
- 数据库直连

#### 12.2 工作流自动化
**功能描述**：根据业务需要自动启动相关工具和流程

**自动化场景**：
- 订单导入时自动启动评审流程
- 生产计划确认时自动生成采购需求
- 异常发生时自动启动应急预案
- 任务完成时自动触发下一步流程
- 报表生成时自动发送给相关人员

## 非功能性需求

### 性能要求
- **响应时间**：页面加载时间 < 3秒，查询响应时间 < 2秒
- **并发处理**：支持100个并发用户，1000个并发订单处理
- **数据处理**：支持10万条订单数据，100万条物料记录
- **通知延迟**：通知发送延迟 < 30秒
- **报表生成**：复杂报表生成时间 < 30秒

### 可靠性要求
- **系统可用性**：99.5%以上（年停机时间 < 44小时）
- **数据备份**：每日自动备份，实时数据同步
- **故障恢复**：故障恢复时间 < 1小时，数据恢复 < 15分钟
- **容错能力**：支持单点故障自动切换

### 安全性要求
- **数据加密**：敏感数据AES-256加密，传输SSL/TLS加密
- **访问控制**：基于角色的权限管理（RBAC）
- **审计日志**：完整的操作审计记录和追溯
- **身份认证**：支持单点登录（SSO）和多因子认证
- **数据隐私**：符合数据保护法规要求

### 兼容性要求
- **操作系统**：Windows 10/11，支持Linux服务器部署
- **浏览器**：Chrome 90+、Edge 90+、Firefox 88+
- **文件格式**：Excel、Word、PDF、CSV、JSON
- **数据库**：PostgreSQL 12+、MySQL 8.0+、SQL Server 2019+
- **移动端**：支持iOS 12+、Android 8.0+

### 可扩展性要求
- **用户扩展**：支持从100用户扩展到1000用户
- **数据扩展**：支持数据量10倍增长
- **功能扩展**：模块化设计，支持功能插件
- **集成扩展**：开放API接口，支持第三方集成

## 用户界面要求

### 主界面设计
- **控制台首页**：显示关键KPI指标和实时状态
- **订单管理**：订单列表、详情、状态跟踪
- **生产计划**：甘特图、看板视图、排程管理
- **物料管理**：库存监控、BOM管理、采购跟踪
- **进度监控**：实时看板、异常预警、质量跟踪
- **报表分析**：各类报表和数据分析图表

### 界面布局
- **顶部导航**：主要功能模块导航
- **侧边菜单**：详细功能菜单和快捷操作
- **主内容区**：核心功能展示和操作区域
- **状态栏**：系统状态、通知提醒、用户信息

### 交互设计
- **响应式设计**：支持PC端、平板、手机多终端
- **直观操作**：拖拽、点击、快捷键等多种操作方式
- **实时更新**：数据实时刷新和状态同步
- **个性化**：支持界面布局和主题自定义
- **无障碍**：支持键盘导航和屏幕阅读器

### 图表要求
- **甘特图**：支持拖拽调整、缩放、依赖关系显示
- **看板**：卡片式任务展示、状态拖拽变更
- **仪表盘**：KPI指标、趋势图、对比分析
- **统计图表**：柱状图、折线图、饼图、热力图
- **实时监控**：数据实时更新、预警提示

## 数据要求

### 数据存储
- **业务数据**：PostgreSQL主数据库存储
- **缓存数据**：Redis缓存热点数据
- **文件数据**：存储在`S:\PG-PMC\AI调度表`和`S:\PG-PMC\project`
- **日志数据**：结构化日志文件存储
- **备份数据**：定期备份到本地和云端

### 数据格式
- **结构化数据**：关系型数据库表结构
- **半结构化数据**：JSON、XML格式
- **文档数据**：Excel、Word、PDF文件
- **图片数据**：产品图片、工艺图纸
- **日志数据**：结构化日志格式

### 数据质量
- **数据完整性**：必填字段验证、关联性检查
- **数据准确性**：数据格式验证、范围检查
- **数据一致性**：跨模块数据同步、事务处理
- **数据时效性**：实时数据更新、过期数据清理

## 集成要求

### MCP工具集成
- **微信通知工具**：企业微信API、微信小程序推送
- **邮件发送工具**：SMTP邮件服务、邮件模板管理
- **短信通知工具**：短信网关API、批量短信发送
- **其他通知工具**：钉钉、Teams、飞书等企业通讯工具

### 现有系统集成
- **ERP系统**：订单数据、客户信息、财务数据同步
- **MES系统**：生产数据、设备状态、质量数据接口
- **WMS系统**：库存数据、出入库记录同步
- **OA系统**：人员信息、组织架构、审批流程
- **CRM系统**：客户信息、销售数据、服务记录

### 第三方服务集成
- **云存储服务**：阿里云、腾讯云、AWS等
- **地图服务**：物流跟踪、供应商位置
- **支付服务**：在线支付、财务对账
- **AI服务**：自然语言处理、图像识别

## 验收标准

### 功能验收
1. **订单管理**：能够正确导入BD400订单数据，完成订单全流程管理
2. **生产计划**：能够生成合理的生产排程，支持甘特图可视化
3. **物料管理**：能够进行BOM管理、库存监控、采购计划
4. **进度跟踪**：能够实时监控生产进度，及时发现和处理异常
5. **通知系统**：所有通知渠道正常工作，到达率≥95%
6. **报表分析**：能够生成各类业务报表和绩效分析
7. **数据记录**：完整记录所有业务操作和状态变更

### 性能验收
1. **响应速度**：页面加载和查询响应时间符合要求
2. **并发处理**：支持指定数量的并发用户和数据处理
3. **稳定性**：连续运行30天无重大故障
4. **数据准确性**：数据处理和计算准确率≥99.9%

### 用户验收
1. **易用性**：普通用户能够在1小时内学会基本操作
2. **满意度**：用户满意度评分≥4.0（5分制）
3. **效率提升**：PMC管理效率提升≥40%
4. **错误率**：用户操作错误率 < 5%

### 安全验收
1. **权限控制**：用户权限管理正确，无越权访问
2. **数据安全**：敏感数据加密存储，传输安全
3. **审计完整**：操作日志完整，可追溯
4. **备份恢复**：数据备份和恢复功能正常

## 项目实施计划

### 开发阶段
1. **需求分析阶段**（2周）：详细需求调研、业务流程梳理
2. **系统设计阶段**（3周）：架构设计、数据库设计、界面设计
3. **开发实现阶段**（12周）：分模块并行开发、单元测试
4. **集成测试阶段**（3周）：系统集成、功能测试、性能测试
5. **用户验收阶段**（2周）：用户培训、试运行、问题修复
6. **上线部署阶段**（1周）：生产环境部署、数据迁移

### 风险控制
- **技术风险**：选择成熟稳定的技术栈，建立技术预研
- **进度风险**：合理安排开发计划，建立里程碑检查
- **质量风险**：建立完善的测试体系，持续集成部署
- **需求风险**：加强需求沟通，建立变更控制流程

---

**文档版本**：V2.0  
**创建日期**：2024年7月20日  
**最后更新**：2024年12月28日  
**文档状态**：已审核  
**审核人员**：PMC技术负责人  
**下次评审**：2025年1月15日